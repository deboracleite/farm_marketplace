!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports.ReactUIDropdown=t(require("react")):e.ReactUIDropdown=t(e.react)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=r(o);t.default=i.default},function(e,t){e.exports=require("react")},function(e,t){var n=function(e){return function(t){return t.split("").map(function(t){return e[t]||t}).join("")}};e.exports=function(e){var t={},r={};for(var o in e){var i=e[o];r[o]=i,t[i]=o;var s=o.toUpperCase();s!==o&&(r[s]=i.toUpperCase(),t[r[s]]=s)}return{fromEn:n(r),toEn:n(t)}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),c=r(a),l=function(e){function t(e){o(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.state={focused:!1},n}return s(t,e),u(t,[{key:"getId",value:function(){return this.props.idPrefix+"item-"+this.props.id}},{key:"getClassName",value:function(){return"dropdown-item"+(this.state.focused?" selected":"")}},{key:"hasImages",value:function(){return this.props.showImages&&!!this.props.image}},{key:"hasSubtitle",value:function(){return!!this.props.subtitle}},{key:"setFocused",value:function(e){this.setState({focused:!!e})}},{key:"render",value:function(){return c.default.createElement("div",{className:this.getClassName(),id:this.getId(),hidden:this.props.selected,style:this.props.selected?{display:"none"}:{},role:"option",tabIndex:"-1",onMouseDown:this.props.onClick,onMouseMove:this.props.onHover},this.hasImages()&&c.default.createElement("img",{className:"dropdown-item-image",src:this.props.image,alt:""}),c.default.createElement("div",{className:"dropdown-item-title"},this.props.title,this.hasSubtitle()&&c.default.createElement("div",{className:"dropdown-item-subtitle"},this.props.subTitle)))}}]),t}(a.Component);t.default=l,l.propTypes={idPrefix:a.PropTypes.string.isRequired,id:a.PropTypes.number.isRequired,selected:a.PropTypes.bool,image:a.PropTypes.string,title:a.PropTypes.string.isRequired,subTitle:a.PropTypes.string,showImages:a.PropTypes.bool,onClick:a.PropTypes.func.isRequired,onHover:a.PropTypes.func.isRequired},l.defaultProps={selected:!1,showImages:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),c=r(a),l=function(e){function t(e){o(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.state={hidden:!0},n}return s(t,e),u(t,[{key:"getId",value:function(){return this.props.idPrefix+"items"}},{key:"getFocusedItemId",value:function(){return this.props.focusedItem?this.props.idPrefix+"item-"+this.props.focusedItem:""}},{key:"setHidden",value:function(e){this.setState({hidden:!!e})}},{key:"render",value:function(){return c.default.createElement("div",{className:"dropdown-items",id:this.getId(),hidden:this.state.hidden,style:this.state.hidden?{display:"none"}:{},role:"listbox",tabIndex:"-1","aria-activedescendant":this.getFocusedItemId()},this.props.children)}}]),t}(a.Component);t.default=l,l.propTypes={idPrefix:a.PropTypes.string.isRequired,focusedItem:a.PropTypes.oneOfType([c.default.PropTypes.number,c.default.PropTypes.string])}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),c=r(a),l=function(e){function t(){return o(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"getId",value:function(){return this.props.idPrefix+"label"}},{key:"getInputId",value:function(){return this.props.idPrefix+"search-input"}},{key:"render",value:function(){return c.default.createElement("label",{className:"dropdown-label",id:this.getId(),htmlFor:this.getInputId()},this.props.children)}}]),t}(a.Component);t.default=l,l.propTypes={idPrefix:a.PropTypes.string.isRequired}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=++T;return e+t}function a(e,t){var n=void 0;return function(){var r=this,o=arguments,i=function(){n=null,e.apply(r,o)},s=!n;clearTimeout(n),n=setTimeout(i,t),s&&e.apply(r,o)}}var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),n(12);var p=n(1),f=r(p),d=n(4),h=r(d),y=n(3),m=r(y),v=n(5),b=r(v),g=n(7),w=r(g),P=n(8),I=r(P),k=n(9),O=r(k),T=0,j=function(e){function t(e){o(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e)),r=n.transformArrayToItems(e.initialItems,e.maxDisplayedItems);return n.state={dropdownId:u("dropdown-")+"-",items:r,focusedItem:r.keys.displayed[0]||null,searchValue:""},n.sendRequest=a(n.sendRequest,500),n}return s(t,e),l(t,[{key:"componentWillUpdate",value:function(e,t){if(this.state.focusedItem!=t.focusedItem){var n=this.refs["item-"+this.state.focusedItem];n&&n.setFocused(!1)}}},{key:"componentDidUpdate",value:function(e,t){if(t.focusedItem!=this.state.focusedItem){var n=this.refs["item-"+this.state.focusedItem];n&&n.setFocused(!0)}}},{key:"getNotSelectedItems",value:function(){var e=this;return this.state.items.keys.displayed.filter(function(t){return!~e.state.items.keys.selected.indexOf(t)})}},{key:"hasRemoteSearch",value:function(){return!(!this.props.remoteSearch||!this.props.remoteSearch.url)}},{key:"handleSelectorClick",value:function(){this.refs.searchInput.refs.input.focus()}},{key:"handleSearchInputChange",value:function(e){var t=this,n=e.target.value;this.setState({searchValue:n});var r=function(e){var n=t.state.items;n.keys.displayed=e,t.setState({items:n,focusedItem:n.keys.displayed.filter(function(e){return!~n.keys.selected.indexOf(e)})[0]||null})};return n.length?void this.goSearch(n,function(e){r(e.slice(0,t.props.maxDisplayedItems))}):void r(this.state.items.keys.started)}},{key:"handleSearchInputKeyDown",value:function(e){var t=this,n=this.state.focusedItem,r=this.getNotSelectedItems(),o=r.indexOf(n),i=function(e){t.setState({focusedItem:r[e]||null})};switch(e.key){case"ArrowDown":i(o<r.length-1?o+1:0);break;case"ArrowUp":i(0==o?r.length-1:o-1);break;case"Enter":this.addItemToSelected(n),i(o<r.length-1?o+1:o-1)}}},{key:"handleSearchInputFocus",value:function(){this.refs.items.setHidden(!1),this.setState({focusedItem:this.getNotSelectedItems()[0]||null});var e=this.refs["item-"+this.state.focusedItem];e&&e.setFocused(!0)}},{key:"handleSearchInputBlur",value:function(){this.refs.items.setHidden(!0);var e=this.refs["item-"+this.state.focusedItem];e&&e.setFocused(!1)}},{key:"handleSelectedItemClick",value:function(e){this.removeItemFromSelected(e)}},{key:"handleItemClick",value:function(e){this.addItemToSelected(e)}},{key:"handleItemHover",value:function(e){this.state.focusedItem!=e&&this.setState({focusedItem:e})}},{key:"dropdownChange",value:function(){var e=this;this.props.onChange&&this.props.onChange(this.state.items.keys.selected.reduce(function(t,n){return t.push(e.state.items.collection[n]),t},[]))}},{key:"transformArrayToItems",value:function(e,t){t=t||this.props.maxDisplayedItems;var n={collection:{},keys:{all:[],started:[],displayed:[],selected:[]}};if(e&&e.length){n.keys.all=e.map(function(e){return e.id});var r=n.keys.all.slice(0,t);n.keys.started=r,n.keys.displayed=r,n.collection=e.reduce(function(e,t){return e[t.id]=t,e},{})}return n}},{key:"sendRequest",value:function(e,t){var n=void 0;try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(r){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){n=!1}}n||"undefined"==typeof XMLHttpRequest||(n=new XMLHttpRequest),n.open("GET",e,!0),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n)},n.send()}},{key:"goSearch",value:function(e,t){var n=this;if(e.length){var r=[],o=["title"];return this.state.items.keys.all.forEach(function(t){O.default.check(e,n.state.items.collection[t],o)&&r.push(t)}),this.hasRemoteSearch()?void this.sendRequest(this.props.remoteSearch.url+"?q="+e+"&search_in="+this.props.remoteSearch.fields,function(e){var n=JSON.parse(e.responseText),o=n.items.map(function(e){return e.id});o.length&&(r=r.concat(o.filter(function(e){return!~r.indexOf(e)}))),t(r)}):void t(r)}}},{key:"addItemToSelected",value:function(e){var t=this.state.items;t.keys.selected=this.props.multiple?this.state.items.keys.selected.concat(e):[e],this.setState({items:t}),this.dropdownChange()}},{key:"removeItemFromSelected",value:function(e){var t=this.state.items.keys.selected;t.splice(t.indexOf(e),1);var n=this.state.items;n.keys.selected=t,this.setState({items:n,focusedItem:this.state.items.keys.displayed.filter(function(e){return!~t.indexOf(e)})[0]}),this.dropdownChange()}},{key:"render",value:function(){var e=this,t=this.state,n=t.dropdownId,r=t.items;return f.default.createElement("div",{className:"dropdown"},f.default.createElement(b.default,{idPrefix:n},this.props.label),f.default.createElement("div",{className:"dropdown-selector",onClick:this.handleSelectorClick.bind(this)},r.keys.selected.map(function(t){return f.default.createElement(I.default,c({key:t,idPrefix:n},r.collection[t],{onClick:e.handleSelectedItemClick.bind(e,t)}))}),f.default.createElement(w.default,{ref:"searchInput",idPrefix:n,value:this.state.searchValue,placeholder:this.props.placeholder,onChange:this.handleSearchInputChange.bind(this),onFocus:this.handleSearchInputFocus.bind(this),onBlur:this.handleSearchInputBlur.bind(this),onKeyDown:this.handleSearchInputKeyDown.bind(this)})),f.default.createElement(h.default,{ref:"items",idPrefix:n,focusedItem:this.state.focusedItem},r.keys.displayed.map(function(t){return f.default.createElement(m.default,c({ref:"item-"+t,key:t,idPrefix:n},r.collection[t],{selected:!!~r.keys.selected.indexOf(t),showImages:e.props.showImages,onClick:e.handleItemClick.bind(e,t),onHover:e.handleItemHover.bind(e,t)}))})))}}]),t}(p.Component);t.default=j,j.propTypes={initialItems:p.PropTypes.array.isRequired,remoteSearch:p.PropTypes.shape({url:f.default.PropTypes.string,fields:f.default.PropTypes.oneOfType([f.default.PropTypes.array,f.default.PropTypes.string])}),maxDisplayedItems:p.PropTypes.number,label:p.PropTypes.string.isRequired,placeholder:p.PropTypes.string,showImages:p.PropTypes.bool,multiple:p.PropTypes.bool,onChange:p.PropTypes.func},j.defaultProps={maxDisplayedItems:10,showImages:!0,multiple:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),c=r(a),l=function(e){function t(){return o(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"getId",value:function(){return this.props.idPrefix+"search-input"}},{key:"getItemsId",value:function(){return this.props.idPrefix+"items"}},{key:"render",value:function(){return c.default.createElement("input",{ref:"input",className:"dropdown-search-input",id:this.getId(),value:this.props.value,placeholder:this.props.placeholder,role:"combobox","aria-autocomplete":"list","aria-owns":this.getItemsId(),onChange:this.props.onChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,onKeyDown:this.props.onKeyDown})}}]),t}(a.Component);t.default=l,l.propTypes={idPrefix:a.PropTypes.string.isRequired,value:a.PropTypes.string,placeholder:a.PropTypes.string,onChange:a.PropTypes.func.isRequired,onFocus:a.PropTypes.func.isRequired,onBlur:a.PropTypes.func.isRequired,onKeyDown:a.PropTypes.func.isRequired},l.defaultProps={value:"",placeholder:""}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),c=r(a),l=function(e){function t(){return o(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"getId",value:function(){return this.props.idPrefix+"selected-item"}},{key:"render",value:function(){return c.default.createElement("div",{className:"dropdown-selected-item",id:this.getId()},c.default.createElement("span",{className:"dropdown-item-title"},this.props.title),c.default.createElement("button",{className:"dropdown-item-close",type:"button",onClick:this.props.onClick},String.fromCharCode(215)))}}]),t}(a.Component);t.default=l,l.propTypes={idPrefix:a.PropTypes.string.isRequired,title:a.PropTypes.string.isRequired,onClick:a.PropTypes.func.isRequired}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),s=r(i),u=void 0,a=void 0,c={check:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];if(!e||"string"!=typeof e)throw new Error("'word' parameter must be a string");if(!t||"object"!=("undefined"==typeof t?"undefined":o(t)))throw new Error("'item' parameter must be an object");e!=u&&(u=e,a=s.default.getConditionalWords(e).map(function(e){return e.replace(/(\[|\]|\(|\)|\\|\.|\^|\$|\||\?|\+)/g,"\\$1")})),n="string"==typeof n?[n]:n||Object.keys(t);for(var r=0;r<n.length;r++)if("string"==typeof t[n[r]])for(var i=t[n[r]].toLowerCase(),c=0;c<a.length;c++)if(~i.search(a[c]))return!0;return!1}};t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=void 0;return t=a.default.fromEn(e),t!=e?t:t=a.default.toEn(e)}function i(e){var t={a:"а",b:"б",v:"в",g:"г",d:"д",e:"е",zh:"ж",z:"з",i:"и",j:"й",k:"к",l:"л",m:"м",n:"н",o:"о",p:"п",r:"р",s:"с",t:"т",u:"у",f:"ф",h:"х",kh:"х",c:"ц",ch:"ч",sh:"ш",shh:"щ","#":"ъ",y:"ы","'":"ь",je:"э",ju:"ю",ja:"я"},n=(0,l.default)(t),r=void 0;return r=n.toEn(e),r!=e?r:r=n.fromEn(e)}function s(e){var t=[];t.push(e);var n=o(e);return t.push(n),n=i(n),t.push(n),n=i(e),t.push(n),n=o(n),t.push(n),t.map(function(e){return e.toLowerCase()})}Object.defineProperty(t,"__esModule",{value:!0});var u=n(11),a=r(u),c=n(2),l=r(c);t.default={convertLayout:o,translit:i,getConditionalWords:s}},function(e,t,n){var r=n(2),o={q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з","[":"х","{":"Х","]":"ъ","}":"Ъ","|":"/","`":"ё","~":"Ё",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",";":"ж",":":"Ж","'":"э",'"':"Э",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",",":"б","<":"Б",".":"ю",">":"Ю","/":".","?":",","@":'"',"#":"№",$:";","^":":","&":"?"};e.exports=r(o)},function(e,t){}])});